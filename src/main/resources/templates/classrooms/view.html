<!DOCTYPE html>
<html th:replace="~{layout :: layout('Classroom', ~{::section} , 'Dashboard')}">
<head>
</head>
<body>
<section x-data="filterStudentsFeature()">

    <script type="application/javascript">
        async function copyToClipboard(element){
            const relativeUrl = element.getAttribute('data-clipboard');
            const url = `${window.location.protocol}//${window.location.host}${relativeUrl}`;
            await navigator.clipboard.writeText(url);
        }

        function filterStudentsFeature() {
            return {
                filter: '',
                filterStudents(studentName) {
                    return studentName.toLowerCase().includes(this.filter.toLowerCase());
                }
            }
        }
    </script>

    <div class="mb-6">
        <div>
            <h5 th:text="${classroom.name}">
                Classroom name
            </h5>
            <div class="mt-1 flex flex-col sm:mt-0 sm:flex-row sm:flex-wrap sm:space-x-6">
                <div class="mt-2 flex items-center text-sm text-gray-500">
                    <img src="/images/users-icon-grey.svg" class="h-6 w-6 mr-1.5" alt="users icon"/>
                    <span th:text="${classroom.students.size}">12</span>&nbsp;Students
                </div>
            </div>
        </div>
        <div class="mt-5 flex lg:ml-4 lg:mt-0">
            <span class="hidden sm:block">
              <a type="button"
                 th:if="${gitlabGroupUrl}"
                 th:href="${gitlabGroupUrl}"
                 target="_blank"
                 class="inline-flex items-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50">
                    <img src="/images/arrow-top-right-on-square-icon-black.svg" class="h-6 w-6 mr-1.5" alt="external link icon"/>
                    <img src="/images/gitlab-icon.svg" class="h-6 w-6 mr-1.5" alt="gitlab icon"/>
                    Open in GitLab
                </a>
            </span>

            <span class="sm:ml-3">
              <button type="button"
                      onclick="copyToClipboard(this)"
                      th:data-clipboard="@{/classrooms/{classroomId}/join(classroomId=${classroom.id})}"
                      class="inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
                <img src="/images/link-icon-white.svg" class="w-6 h-6 mr-1.5 text-white" alt="link icon"/>
                Copy Join Link
              </button>
            </span>
        </div>
    </div>

    <div class="border-b border-gray-200 pb-5 sm:flex sm:items-center sm:justify-between">
        <div>
            <h3 class="text-base font-semibold leading-6 text-gray-900">Students</h3>
            <p class="max-w-4xl text-sm text-gray-500">Students who already joined the Classroom.</p>
        </div>

        <div class="mt-3 flex sm:ml-4 sm:mt-0">
            <div class="relative rounded-md shadow-sm">
                <div class="pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3">
                    <img src="/images/users-icon-grey.svg" class="h-6 w-6 mr-1.5" alt="users icon" />
                </div>
                <input
                        x-model="filter"
                        type="text"
                        class="block w-full rounded-md border-0 px-3 py-1.5 pl-10 text-gray-900 ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6"
                        placeholder="Search for Students">
            </div>
        </div>
    </div>

    <ul role="list" class="grid grid-cols-3 gap-6 mt-6">
        <li th:each="student: ${classroom.students}"
            th:x-show="|filterStudents('${student.name}')|"
            th:insert="~{ components/student-card::div(${student}) }"
            th:with="link=@{/classrooms/{classroomId}/students/{studentName}(classroomId=${classroom.id},studentName=${student.name})}"
            >
        </li>
    </ul>

    <div class="border-b border-gray-200 mt-5 pb-5 sm:flex sm:items-center sm:justify-between">
        <div>
            <h3 class="text-base font-semibold leading-6 text-gray-900">Assignments</h3>
            <p class="max-w-4xl text-sm text-gray-500">Assignments of the current classroom.</p>
        </div>
        <div class="mt-3 flex sm:ml-4 sm:mt-0">
            <a th:href="@{/classrooms/{classroomId}/assignments/new(classroomId=${classroom.id})}"
                    type="button"
                    class="ml-3 inline-flex items-center rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600">
                New Assignment
            </a>
        </div>
    </div>

    <ul role="list" class="grid grid-cols-3 gap-6 mt-6">
        <li th:each="assignment : ${classroom.assignments}"
            th:insert="~{ components/assignment-card::div(${assignment}) }"
            th:with="link=@{/assignments/{assignmentId}(assignmentId=${assignment.id})}"
        >
        </li>
    </ul>


</section>
</body>
</html>
